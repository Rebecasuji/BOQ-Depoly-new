import { Switch, Route } from "wouter";
import { queryClient } from "./lib/queryClient";
import { QueryClientProvider } from "@tanstack/react-query";
import { DataProvider } from "./lib/store";
import { Toaster } from "@/components/ui/toaster";
import { TooltipProvider } from "@/components/ui/tooltip";
import NotFound from "@/pages/not-found";
import Login from "@/pages/Login";
import Dashboard from "@/pages/Dashboard";
import AdminDashboard from "@/pages/admin/AdminDashboard";
import CivilWallEstimator from "@/pages/estimators/CivilWallEstimator";
import FlooringEstimator from "@/pages/estimators/FlooringEstimator";
import FalseCeilingEstimator from "@/pages/estimators/FalseCeilingEstimator";
import PaintingEstimator from "@/pages/estimators/PaintingEstimator";
import DoorsEstimator from "@/pages/estimators/DoorsEstimator";
import BlindsEstimator from "@/pages/estimators/BlindsEstimator";
import ElectricalEstimator from "@/pages/estimators/ElectricalEstimator";
import PlumbingEstimator from "@/pages/estimators/PlumbingEstimator";
import MSWorkEstimator from "@/pages/estimators/MSWorkEstimator";
import SSWorkEstimator from "@/pages/estimators/SSWorkEstimator";
import FireFightingEstimator from "@/pages/estimators/FireFightingEstimator";
import ItemMaster from "@/pages/ItemMaster";
import ShopDetails from "@/pages/ShopDetails";
import CostSummary from "@/pages/CostSummary";

function Router() {
  return (
    <Switch>
      <Route path="/" component={Login} />
      <Route path="/dashboard" component={Dashboard} />
      <Route path="/estimators/civil-wall" component={CivilWallEstimator} />
      <Route path="/estimators/flooring" component={FlooringEstimator} />
      <Route path="/estimators/false-ceiling" component={FalseCeilingEstimator} />
      <Route path="/estimators/painting" component={PaintingEstimator} />
      <Route path="/estimators/doors" component={DoorsEstimator} />
      <Route path="/estimators/blinds" component={BlindsEstimator} />
      <Route path="/estimators/electrical" component={ElectricalEstimator} />
      <Route path="/estimators/plumbing" component={PlumbingEstimator} />
      <Route path="/estimators/ms-work" component={MSWorkEstimator} />
      <Route path="/estimators/ss-work" component={SSWorkEstimator} />
      <Route path="/estimators/fire-fighting" component={FireFightingEstimator} />
      <Route path="/item-master" component={ItemMaster} />
      <Route path="/item-master/:id" component={ShopDetails} />
      <Route path="/cost-summary" component={CostSummary} />
      <Route path="/admin/dashboard" component={AdminDashboard} />
      {/* Add other routes as needed or map them to a placeholder for now */}
      <Route path="/estimators/:type" component={Dashboard} /> 
      <Route component={NotFound} />
    </Switch>
  );
}

function App() {
  return (
    <QueryClientProvider client={queryClient}>
      <DataProvider>
        <TooltipProvider>
          <Toaster />
          <Router />
        </TooltipProvider>
      </DataProvider>
    </QueryClientProvider>
  );
}

export default App;
import { createRoot } from "react-dom/client";
import App from "./App";
import "./index.css";

createRoot(document.getElementById("root")!).render(<App />);
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />

    <meta property="og:title" content="BuildEstimate Pro" />
    <meta property="og:description" content="Professional Construction & Interior Estimator Tool" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://replit.com/public/images/opengraph.png" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@replit" />
    <meta name="twitter:title" content="BuildEstimate Pro" />
    <meta name="twitter:description" content="Professional Construction & Interior Estimator Tool" />
    <meta name="twitter:image" content="https://replit.com/public/images/opengraph.png" />

    <link rel="icon" type="image/png" href="/favicon.png" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@300;400;500;600;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
import { ReactNode } from "react";
import { Sidebar } from "./Sidebar";

interface LayoutProps {
  children: ReactNode;
}

export function Layout({ children }: LayoutProps) {
  return (
    <div className="min-h-screen bg-background text-foreground">
      <Sidebar />
      <main className="md:pl-64 min-h-screen transition-all duration-200">
        <div className="container mx-auto p-4 md:p-8 pt-16 md:pt-8 max-w-7xl">
          {children}
        </div>
      </main>
    </div>
  );
}
import { useState } from "react";
import { Link, useLocation } from "wouter";
import { cn } from "@/lib/utils";
import {
  LayoutDashboard,
  BrickWall,
  DoorOpen,
  Cloud,
  Layers,
  PaintBucket,
  Blinds,
  Zap,
  Droplets,
  Hammer,
  ShieldAlert,
  Menu,
  X
} from "lucide-react";
import { Button } from "@/components/ui/button";

const sidebarItems = [
  { icon: LayoutDashboard, label: "Dashboard", href: "/dashboard" },
  { icon: BrickWall, label: "Civil Wall / Partition", href: "/estimators/civil-wall" },
  { icon: DoorOpen, label: "Doors", href: "/estimators/doors" },
  { icon: Cloud, label: "False Ceiling", href: "/estimators/false-ceiling" },
  { icon: Layers, label: "Flooring", href: "/estimators/flooring" },
  { icon: PaintBucket, label: "Painting", href: "/estimators/painting" },
  { icon: Blinds, label: "Blinds", href: "/estimators/blinds" },
  { icon: Zap, label: "Electrical", href: "/estimators/electrical" },
  { icon: Droplets, label: "Plumbing", href: "/estimators/plumbing" },
  { icon: Hammer, label: "MS Work", href: "/estimators/ms-work" },
  { icon: Hammer, label: "SS Work", href: "/estimators/ss-work" },
  { icon: ShieldAlert, label: "Fire-Fighting Works", href: "/estimators/fire-fighting" },
];

export function Sidebar() {
  const [location] = useLocation();
  const [isOpen, setIsOpen] = useState(true);

  return (
    <>
      {/* Mobile Toggle */}
      <Button
        variant="ghost"
        size="icon"
        className="fixed top-4 left-4 z-50 md:hidden"
        onClick={() => setIsOpen(!isOpen)}
      >
        {isOpen ? <X className="h-6 w-6" /> : <Menu className="h-6 w-6" />}
      </Button>

      {/* Sidebar Container */}
      <aside
        className={cn(
          "fixed inset-y-0 left-0 z-40 w-64 transform bg-sidebar border-r border-sidebar-border transition-transform duration-200 ease-in-out md:translate-x-0",
          isOpen ? "translate-x-0" : "-translate-x-full"
        )}
      >
        <div className="flex h-16 items-center justify-center border-b border-sidebar-border bg-sidebar-primary/10">
          <h1 className="text-xl font-bold tracking-tight text-sidebar-primary font-display">
            BUILD<span className="text-foreground">ESTIMATE</span>
          </h1>
        </div>

        <nav className="flex-1 overflow-y-auto py-4 px-3 space-y-1">
          {sidebarItems.map((item) => {
            const isActive = location === item.href;
            return (
              <Link key={item.href} href={item.href}>
                <a
                  className={cn(
                    "flex items-center gap-3 rounded-md px-3 py-2 text-sm font-medium transition-colors",
                    isActive
                      ? "bg-sidebar-primary text-sidebar-primary-foreground shadow-md"
                      : "text-sidebar-foreground hover:bg-sidebar-accent hover:text-sidebar-accent-foreground"
                  )}
                >
                  <item.icon className="h-4 w-4" />
                  {item.label}
                </a>
              </Link>
            );
          })}
        </nav>

        <div className="border-t border-sidebar-border p-4">
          <div className="flex items-center gap-3">
            <div className="h-8 w-8 rounded-full bg-sidebar-primary/20 flex items-center justify-center text-sidebar-primary font-bold">
              JD
            </div>
            <div className="flex flex-col">
              <span className="text-sm font-medium text-sidebar-foreground">John Doe</span>
              <span className="text-xs text-muted-foreground">Admin</span>
            </div>
          </div>
        </div>
      </aside>
    </>
  );
}
import * as React from "react"

const MOBILE_BREAKPOINT = 768

export function useIsMobile() {
  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)

  React.useEffect(() => {
    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)
    const onChange = () => {
      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)
    }
    mql.addEventListener("change", onChange)
    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)
    return () => mql.removeEventListener("change", onChange)
  }, [])

  return !!isMobile
}
import * as React from "react"

import type {
  ToastActionElement,
  ToastProps,
} from "@/components/ui/toast"

const TOAST_LIMIT = 1
const TOAST_REMOVE_DELAY = 1000000

type ToasterToast = ToastProps & {
  id: string
  title?: React.ReactNode
  description?: React.ReactNode
  action?: ToastActionElement
}

const actionTypes = {
  ADD_TOAST: "ADD_TOAST",
  UPDATE_TOAST: "UPDATE_TOAST",
  DISMISS_TOAST: "DISMISS_TOAST",
  REMOVE_TOAST: "REMOVE_TOAST",
} as const

let count = 0

function genId() {
  count = (count + 1) % Number.MAX_SAFE_INTEGER
  return count.toString()
}

type ActionType = typeof actionTypes

type Action =
  | {
      type: ActionType["ADD_TOAST"]
      toast: ToasterToast
    }
  | {
      type: ActionType["UPDATE_TOAST"]
      toast: Partial<ToasterToast>
    }
  | {
      type: ActionType["DISMISS_TOAST"]
      toastId?: ToasterToast["id"]
    }
  | {
      type: ActionType["REMOVE_TOAST"]
      toastId?: ToasterToast["id"]
    }

interface State {
  toasts: ToasterToast[]
}

const toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()

const addToRemoveQueue = (toastId: string) => {
  if (toastTimeouts.has(toastId)) {
    return
  }

  const timeout = setTimeout(() => {
    toastTimeouts.delete(toastId)
    dispatch({
      type: "REMOVE_TOAST",
      toastId: toastId,
    })
  }, TOAST_REMOVE_DELAY)

  toastTimeouts.set(toastId, timeout)
}

export const reducer = (state: State, action: Action): State => {
  switch (action.type) {
    case "ADD_TOAST":
      return {
        ...state,
        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),
      }

    case "UPDATE_TOAST":
      return {
        ...state,
        toasts: state.toasts.map((t) =>
          t.id === action.toast.id ? { ...t, ...action.toast } : t
        ),
      }

    case "DISMISS_TOAST": {
      const { toastId } = action

      // ! Side effects ! - This could be extracted into a dismissToast() action,
      // but I'll keep it here for simplicity
      if (toastId) {
        addToRemoveQueue(toastId)
      } else {
        state.toasts.forEach((toast) => {
          addToRemoveQueue(toast.id)
        })
      }

      return {
        ...state,
        toasts: state.toasts.map((t) =>
          t.id === toastId || toastId === undefined
            ? {
                ...t,
                open: false,
              }
            : t
        ),
      }
    }
    case "REMOVE_TOAST":
      if (action.toastId === undefined) {
        return {
          ...state,
          toasts: [],
        }
      }
      return {
        ...state,
        toasts: state.toasts.filter((t) => t.id !== action.toastId),
      }
  }
}

const listeners: Array<(state: State) => void> = []

let memoryState: State = { toasts: [] }

function dispatch(action: Action) {
  memoryState = reducer(memoryState, action)
  listeners.forEach((listener) => {
    listener(memoryState)
  })
}

type Toast = Omit<ToasterToast, "id">

function toast({ ...props }: Toast) {
  const id = genId()

  const update = (props: ToasterToast) =>
    dispatch({
      type: "UPDATE_TOAST",
      toast: { ...props, id },
    })
  const dismiss = () => dispatch({ type: "DISMISS_TOAST", toastId: id })

  dispatch({
    type: "ADD_TOAST",
    toast: {
      ...props,
      id,
      open: true,
      onOpenChange: (open) => {
        if (!open) dismiss()
      },
    },
  })

  return {
    id: id,
    dismiss,
    update,
  }
}

function useToast() {
  const [state, setState] = React.useState<State>(memoryState)

  React.useEffect(() => {
    listeners.push(setState)
    return () => {
      const index = listeners.indexOf(setState)
      if (index > -1) {
        listeners.splice(index, 1)
      }
    }
  }, [state])

  return {
    ...state,
    toast,
    dismiss: (toastId?: string) => dispatch({ type: "DISMISS_TOAST", toastId }),
  }
}

export { useToast, toast }
import React, { createContext, useContext, useState, ReactNode } from "react";

// Types
export interface Shop {
  id: number;
  name: string;
  location: string;
  phone: string;
  city?: string;
  state?: string;
  country?: string;
  pincode?: string;
  image?: string;
  rating?: number;
  categories?: string[];
}

export interface Material {
  id: number;
  shopId: number;
  name: string;
  code: string;
  rate: number;
  unit: string;
  category: string;
  brandName?: string;
  modelNumber?: string;
  subCategory?: string;
  technicalSpecification?: string;
  image?: string;
}

interface DataContextType {
  shops: Shop[];
  materials: Material[];
  setShops: (shops: Shop[]) => void;
  setMaterials: (materials: Material[]) => void;
  addShop: (shop: Shop) => void;
  addMaterial: (material: Material) => void;
  getMaterialsByShop: (shopId: number) => Material[];
  cart: { materialId: number; quantity: number }[];
  addToCart: (materialId: number, quantity: number) => void;
  updateCartQuantity: (materialId: number, quantity: number) => void;
  removeFromCart: (materialId: number) => void;
  clearCart: () => void;
}

const DataContext = createContext<DataContextType | undefined>(undefined);

export const DataProvider = ({ children }: { children: ReactNode }) => {
  const [shops, setShopsState] = useState<Shop[]>([]);
  const [materials, setMaterialsState] = useState<Material[]>([]);
  const [cart, setCart] = useState<{ materialId: number; quantity: number }[]>([]);

  // Use these to load data from Database
  const setShops = (newShops: Shop[]) => setShopsState(newShops);
  const setMaterials = (newMats: Material[]) => setMaterialsState(newMats);

  const addShop = (shop: Shop) => {
    setShopsState((prev) => {
      if (prev.find((s) => s.id === shop.id)) return prev;
      return [...prev, shop];
    });
  };

  const addMaterial = (material: Material) => {
    setMaterialsState((prev) => {
      if (prev.find((m) => m.id === material.id)) return prev;
      return [...prev, material];
    });
  };

  const getMaterialsByShop = (shopId: number) => {
    return materials.filter((m) => m.shopId === shopId);
  };

  const addToCart = (materialId: number, quantity: number) => {
    setCart((prev) => {
      const existing = prev.find((item) => item.materialId === materialId);
      if (existing) {
        return prev.map((item) =>
          item.materialId === materialId
            ? { ...item, quantity: item.quantity + quantity }
            : item
        );
      }
      return [...prev, { materialId, quantity }];
    });
  };

  const updateCartQuantity = (materialId: number, quantity: number) => {
    if (quantity <= 0) {
      removeFromCart(materialId);
      return;
    }
    setCart((prev) =>
      prev.map((item) =>
        item.materialId === materialId ? { ...item, quantity } : item
      )
    );
  };

  const removeFromCart = (materialId: number) => {
    setCart((prev) => prev.filter((item) => item.materialId !== materialId));
  };

  const clearCart = () => setCart([]);

  return (
    <DataContext.Provider
      value={{
        shops,
        materials,
        setShops,
        setMaterials,
        addShop,
        addMaterial,
        getMaterialsByShop,
        cart,
        addToCart,
        updateCartQuantity,
        removeFromCart,
        clearCart,
      }}
    >
      {children}
    </DataContext.Provider>
  );
};

export const useData = () => {
  const context = useContext(DataContext);
  if (!context) {
    throw new Error("useData must be used within a DataProvider");
  }
  return context;
};